# PR-17: Upgrade safety: rollback reference + atomic-ish apply

## Goal
Add rollback support and safer upgrade semantics.

## Scope
Local rollback reference in bootstrap state + basic atomic staging.

## Changes
- Before upgrade apply:
  - snapshot previous config + record previous pack digest/version reference
- If apply fails:
  - revert config
  - optionally revert secrets if backend supports versioning (otherwise warn)
- Add `greentic-deployer platform rollback` (optional) OR record rollback info for operator.

## Acceptance Criteria
- Failed upgrade leaves system in known state.
- Bootstrap state contains rollback reference.

## Tests
- Simulate failure mid-apply -> config reverted, state not advanced.

## Notes
- Keep rollback minimal and auditable.
