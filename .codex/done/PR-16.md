# PR-16: Upgrade path: preflight + upgrade flow + state transitions

## Goal
Implement `platform upgrade` executing `platform_upgrade.ygtc` and applying results safely.

## Scope
Upgrade flow execution + state changes.

## Changes
- Add compatibility checks:
  - installed version/digest present
  - pack version newer or explicitly allowed
- Run upgrade flow -> outputs -> apply secrets writes -> apply config_patch -> apply plan
- Record last successful upgrade in bootstrap state.

## Acceptance Criteria
- `platform upgrade` works end-to-end with fixture.
- Clear errors for “not installed” or incompatible upgrade.

## Tests
- Not-installed -> fails with guidance
- Valid upgrade -> succeeds + state updated

## Notes
- Rollback comes next PR.
